<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Math</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
	<div id="gameover">
		<h1>Game over</h1>
		<div id="score">Score: <span>0</span></div>
		<div id="highscore">Highscore: <span>0</span></div>
		<button id="retry">Try again!</button>
	</div>
	<div id="timer"></div>
	<div id="problem">2+2=5</div>
	<button id="correct">&#xf00c;</button>
	<button id="wrong">&#xf00d;</button>
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<script src="js/tappy.js"></script>
	<script>
		function getRandomInt(min, max) {
		    return Math.floor(Math.random() * (max - min + 1)) + min;
		}

		var first, second, answer, score = 0, highscore = 0, running = false;

		generateProblem();

		$('#timer').addClass('hidden');
		$('#gameover').hide();

		function generateProblem() {
			first = getRandomInt(1, 5);
			second = getRandomInt(1, 5);
			answer = first + second;

			if (getRandomInt(0, 10) < 7) {
				answer += Math.max(getRandomInt(-3, 3), 0);
			}

			$('#problem').text(first + '+' + second + '=' + answer);
		}

		function start() {

		}

		function gameOver() {
			if (score > highscore) {
				highscore = score;
			}

			$('#score span').text(score);
			$('#highscore span').text(highscore);
			$('#timer').stop().addClass('hidden');
			$('#gameover').show();

			score = 0;
		}

		function checkAnswer(guess) {
			if ($('#gameover').is(':visible')) return false;

			if ((guess && first + second == answer) || (!guess && first + second != answer)) {
				addScore();
			} else {
				gameOver();
			}
		}

		function nextProblem() {
			generateProblem();

			$('#timer').removeClass('hidden').css({
				width: '100%'
			}).stop().animate({
				width: 0
			}, {
				duration: 2000,
				easing: 'linear',
				queue: false,
				complete: gameOver
			});
		}

		function addScore() {
			score += 1;

			nextProblem();
		}

		$('#correct').on('tap', function() {
			checkAnswer(true);
		});

		$('#wrong').on('tap', function() {
			checkAnswer(false);
		});

		$('#retry').on('tap', function() {
			$('#gameover').hide();
			start();
		});
	</script>
</body>
</html>